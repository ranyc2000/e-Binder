<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="stylesheet" type="text/css" href="igen.css">
<link rel='icon' href='favicon.ico'>
<link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css'>
<title id='ttle'>Binder Index</title>
<script type="text/javascript" src="lib/js/jquery-latest.js"></script>
<script type="text/javascript" src="lib/js/jquery-ui-latest.js"></script>
<script type="text/javascript" src="lib/js/jquery.layout-latest.js"></script>
<script src="gendata.js"></script>
<!-- gendata.js above is separately generated by Excel. It sets the following variables for use here: 
  jRowsPerPage, jTitle, jInitialSrc, Items[]
-->
<script language=JavaScript>
document.getElementById("ttle").innerHTML = jTitle;
var myLayout; // a var is required because this page utilizes: myLayout.allowOverflow() method
$(document).ready(function () {
    myLayout = $('body').layout({
            west__size:                 850
        ,   west__spacing_closed:       20
        ,   west__togglerLength_closed: 100
        ,   west__togglerAlign_closed:  "top"
        ,   west__togglerContent_closed:"M<BR>E<BR>N<BR>U"
        ,   west__togglerTip_closed:    "Open & Pin Menu"
        ,   west__sliderTip:            "Slide Open Menu"
        ,   west__slideTrigger_open:    "mouseover"
        ,   center__maskContents:       true // IMPORTANT - enable iframe masking
    });
});

N = 0; // N tracks the last line displayed in the left pane (Doc listing)

numItems = items.length;
actualRowsPerPage = jRowsPerPage - 2; // usually around 28-42 depending on expected screen size (give or take)


// The rewrite() function - rewrites the Doc Table with actual data from the pre-generated Items[] structure
function rewrite( j ) {
  if (j > maxRows) j = maxRows;
  if (j < 0) j = 0;
  gSelected = j + 2;
  for (k=2; k<jRowsPerPage; k++) {
    var x=document.getElementById('row' + k);
    if(j+k-1<maxRows) x.innerHTML = '<td style=text-align:center>'+ items[j+k-2].Id +'</td>' 
    + '<td style=text-align:center>'+items[j+ (k-2)].Date + '</td>' 
    + '<td><abbr data-p="'+items[j+ (k-2)].Path
      +'" data-s="'+items[j+ (k-2)].Summary
      +'" title="'+items[j+ (k-2)].Summary+'">' 
      + items[j+ (k-2)].Score + ' ' + items[j+ (k-2)].Title 
      + '</abbr></td>';
    else x.innerHTML='<td>&nbsp</td><td>&nbsp</td><td>&nbsp</td>';
    //N = j+ k - 1
  }
  N = j + k -2;
}
// OnMouseOver function
function omo(passedID){
  document.getElementById(passedID).style.cursor = 'pointer';
}
</script>
</head>

<!-- BODY -->
<body>
<iframe id="mainFrame" name="mainFrame" class="ui-layout-center"
width="100%" height="600" frameborder="0" scrolling="auto"
src=""></iframe>
<div class="ui-layout-west"><br>
  <div class="header" id="header">
    <h3 id="vTitle">BINDER INDEX</h3>
  </div>
  <table id=DocT width=100% style='font-family:sans-serif;font-size:16px'>
    <tr><th width=6%>#</th><th width=15%>Date</th><th>Title</th></tr>
  </table>

<script>
// Code to generate placeholder Doc Table, which gets rewritten later
var table = document.getElementById("DocT");
for ( i=2; i < jRowsPerPage; i++ ) {
  var row=table.insertRow( i - 1 )
  row.id = 'row' + i;
  row.addEventListener("mouseover", function(){ omo (this.id);});
} 

document.getElementById('vTitle').innerHTML = jTitle;
document.getElementById('mainFrame').src = jInitialSrc;
// Code to manage highlighting of the selected row in Doc Table
$('#DocT').find('tr').click( function(){
  Clicked=($(this).index()+1)
  sn=(gSelected-2)*3;
  $('td').slice(sn,sn+3).css('background-color','#f1f1f1');
  gSelected=Clicked;
  sn=(Clicked-2)*3;
  $('td').slice(sn, sn+3).css('background-color', '#d4f442');
  source = $(this).find('abbr').attr('data-p');
  extpos = source.lastIndexOf('.xls');
  if (extpos > -1) alert('Excel file -- opens in its own tab');
  document.getElementById('mainFrame').src = source;
  document.getElementById('summaryDiv').innerHTML = "<b>Summary of selected item:</b> " + $(this).find('abbr').attr('data-s');
}); 
</script>
<!-- Navigation elements -->
<div class="navbar" id="navbar">
  <a href='#' onClick='rewrite(N);'>PgFwd</a>
  <a href='#' onClick='rewrite(N-2*jRowsPerPage+4);'>PgBck</a>
  <a href='#' onClick='rewrite(0);'>First</a>
  <a href='#' onClick='rewrite(numItems - actualRowsPerPage);'>Last</a>
  <a href='#' onClick='rewrite(N - jRowsPerPage - 0);'><</a>
  <a href='#' onClick='rewrite(N - jRowsPerPage + 4);'>></a>
</div>
<div id="summaryDiv" class="ui-layout-west" style="font-size: 13px;color:mediumblue;"></div>
<script>
document.getElementById('summaryDiv').innerHTML = "<b>Summary of selected item:</b> " + items[0].Summary;
rewrite(0);
$('td').slice(0, 3).css('background-color', '#d4f442');
</script>
</div> <!-- end of ui-layout-west -->
</body><html>
